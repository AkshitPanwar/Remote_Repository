learning on branches and merging